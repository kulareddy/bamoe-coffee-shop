#####################################
# Quarkus settings
#####################################
%dev.quarkus.http.port=8081

quarkus.http.cors=true
quarkus.dev-ui.cors.enabled=false
quarkus.http.cors.origins="/.*/"
quarkus.swagger-ui.always-include=true
quarkus.smallrye-openapi.path=docs/openapi.json
quarkus.kogito.data-index.graphql.ui.always-include=true

#####################################
# Events settings
#####################################
kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}

mp.messaging.outgoing.make-drink.connector=smallrye-kafka
mp.messaging.outgoing.make-drink.topic=order-drink
mp.messaging.outgoing.make-drink.value.serializer=org.apache.kafka.common.serialization.StringSerializer


mp.messaging.incoming.drink-ready.connector=smallrye-kafka
mp.messaging.incoming.drink-ready.topic=order-drink
mp.messaging.incoming.drink-ready.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.incoming.drink-ready.auto.offset.reset=earliest

#####################################
# Persistence settings
#####################################
kie.flyway.enabled=true
# Tells the Kogito runtime what kind of persistence is configured.
kogito.persistence.type=jdbc

quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=${POSTGRES_USER:kogito}
quarkus.datasource.password=${POSTGRES_PASSWORD:kogito}
quarkus.datasource.jdbc.url=jdbc:postgresql://${POSTGRES_HOST:localhost}:${POSTGRES_PORT:5432}/${POSTGRES_DB:kogito}
quarkus.datasource.reactive.url=postgresql://${${POSTGRES_HOST:localhost}}:${POSTGRES_PORT:5432}/${POSTGRES_DB:kogito}

# Disabling Hibernate schema generation
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.validate-in-dev-mode=false

#####################################
# Transactions
#####################################


#####################################
# Jobs Service configuration
#####################################
kogito.jobs-service.url=http://${JOBS_SERVICE_HOST:localhost}:${JOBS_SERVICE_PORT:${quarkus.http.port}}
# run periodic job loading every minute
kogito.jobs-service.loadJobIntervalInMinutes=1
# load jobs into the InMemory scheduler that expire within the next 10 minutes
kogito.jobs-service.schedulerChunkInMinutes=10
# (re)load jobs into the InMemory scheduler that have expired in the last 5 minutes and have not been properly executed
kogito.jobs-service.loadJobFromCurrentTimeIntervalInMinutes=5


#####################################
# Services definition
#####################################
kogito.service.url=http://${KOGITO_SERVICE_HOST:localhost}:${KOGITO_SERVICE_PORT:${quarkus.http.port}}
kogito.data-index.url=http://${INDEX_SERVICE_HOST:localhost}:${INDEX_SERVICE_PORT:${quarkus.http.port}}

#####################################
# Security & Dev UI
#####################################
quarkus.oidc.enabled=false
kogito.security.auth.enabled=true
%dev.kogito.security.auth.impersonation.enabled=true
%dev.bamoe.devui.users.jdoe.groups=cashier
%dev.bamoe.devui.users.dave.groups=manager
%dev.kogito.security.auth.impersonation.allowed-for-roles=managers


#####################################
# Logging
#####################################
